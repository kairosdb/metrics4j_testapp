<?xml version="1.0" encoding="UTF-8" ?>

<metrics4j>
	<sources name="ROOT">
		<!-- defaults are declared at the root -->
		<collector ref="Counter"/>
		<collector ref="Timer"/>
		<formatter ref="template"/>
		<trigger ref="myTrigger"/>

		<source name="org" configuration="strict"> <!-- strict requires a configuration for every collectors, no default behavior -->
			<source name="kairosdb">
				<source name="metrics4j_testapp">
					<sink ref="slf4j"/>
					<source name="TestStats">
						<source name="countSomethingWithTag">
							<formatter ref="templateWithStatus"/>
						</source>
					</source>
				</source>
			</source>
		</source>
	</sources>
	<sinks>
		<sink name="slf4j" class="org.kairosdb.metrics4j.sinks.Slf4JMetricSink" logLevel="error"/>
	</sinks>
	<collectors>
		<collector name="Counter" class="org.kairosdb.metrics4j.collectors.LongCounter"/>
		<collector name="Timer" class="org.kairosdb.metrics4j.collectors.SimpleTimerMetric"/>
	</collectors>
	<formatters>
		<formatter name="template" class="org.kairosdb.metrics4j.formatters.TemplateFormatter"
		           template="metric4j.${className}.${methodName}.${field}"/>
		<formatter name="templateWithStatus" class="org.kairosdb.metrics4j.formatters.TemplateFormatter"
		           template="metric4j.${className}.${methodName}.${tag.status}.${field}"/>
	</formatters>

	<triggers> <!-- determines when to collect metrics -->
		<trigger name="myTrigger" class="org.kairosdb.metrics4j.triggers.IntervalTrigger" interval="5" unit="SECONDS"/>
	</triggers>
</metrics4j>